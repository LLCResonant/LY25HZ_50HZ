utils.loadPlatform("ti.platforms.control28035");

/* The following DSP/BIOS Features are enabled.  */
bios.enableRealTimeAnalysis(prog);
bios.enableRtdx(prog);
bios.enableTskManager(prog);

bios.GBL.PLLTYPE = "2803x";
bios.GBL.MODIFYPLLCR3 = 0;
bios.GBL.CALLUSERINITFXN = 1;
bios.GBL.USERINITFXN = prog.extern("UserInit");

bios.MEM.NOMEMORYHEAPS = 0;
bios.MEM.create("M0SARAM");
bios.MEM.instance("M0SARAM").comment = "On-Chip RAM Memory";
bios.MEM.instance("M0SARAM").len = 0x0400;
bios.MEM.instance("M0SARAM").createHeap = 0;
bios.MEM.create("M1SARAM");
bios.MEM.instance("M1SARAM").comment = "On-Chip RAM Memory";
bios.MEM.instance("M1SARAM").base = 0x000400;
bios.MEM.instance("M1SARAM").len = 0x0400;
bios.MEM.instance("M1SARAM").createHeap = 1;

bios.MEM.create("LDPSARAM");
bios.MEM.instance("LDPSARAM").comment = "On-Chip RAM Memory";
bios.MEM.instance("LDPSARAM").base = 0x008000;
bios.MEM.instance("LDPSARAM").len = 0x2000;
bios.MEM.instance("LDPSARAM").createHeap = 0;
bios.MEM.instance("LDPSARAM").space = "code/data";

bios.MEM.create("FLASH_ABCDEFGH");
bios.MEM.instance("FLASH_ABCDEFGH").base = 0x3e8000;
bios.MEM.instance("FLASH_ABCDEFGH").len = 0xff80;
bios.MEM.instance("FLASH_ABCDEFGH").createHeap = 0;
bios.MEM.instance("FLASH_ABCDEFGH").comment = "On-chip Flash Memory";
bios.MEM.instance("FLASH_ABCDEFGH").space = "code";
bios.MEM.create("PASSWORDS");
bios.MEM.instance("PASSWORDS").base = 0x3f7ff8;
bios.MEM.instance("PASSWORDS").len = 0x0008;
bios.MEM.instance("PASSWORDS").createHeap = 0;
bios.MEM.instance("PASSWORDS").space = "code";
bios.MEM.create("BEGIN_M0");
bios.MEM.instance("BEGIN_M0").comment = "Boot to M0 Entry Point";
bios.MEM.instance("BEGIN_M0").len = 0x0002;
bios.MEM.instance("BEGIN_M0").createHeap = 0;
bios.MEM.instance("BEGIN_M0").space = "code";
bios.MEM.instance("PASSWORDS").comment = "CSM Passwords in Flash";
bios.MEM.create("BEGIN_FLASH");
bios.MEM.instance("BEGIN_FLASH").comment = "Boot to Flash Entry Point";
bios.MEM.instance("BEGIN_FLASH").base = 0x3f7ff6;
bios.MEM.instance("BEGIN_FLASH").len = 0x0002;
bios.MEM.instance("BEGIN_FLASH").createHeap = 0;
bios.MEM.instance("BEGIN_FLASH").space = "code";
bios.MEM.create("CSM_RSVD");
bios.MEM.instance("CSM_RSVD").comment = "Reserved by CSM";
bios.MEM.instance("CSM_RSVD").base = 0x3f7f80;
bios.MEM.instance("CSM_RSVD").len = 0x0076;
bios.MEM.instance("CSM_RSVD").createHeap = 0;
bios.MEM.instance("CSM_RSVD").space = "code";
bios.MEM.instance("BOOTROM").base = 0x3ff27c;
bios.MEM.instance("BOOTROM").len = 0x0d44;
bios.MEM.create("IQTABLES");
bios.MEM.instance("IQTABLES").comment = "IQmath table 1 in Boot ROM";
bios.MEM.instance("IQTABLES").base = 0x3fE000;
bios.MEM.instance("IQTABLES").len = 0x0b50;
bios.MEM.instance("IQTABLES").createHeap = 0;
bios.MEM.instance("IQTABLES").space = "code";
bios.MEM.create("IQTABLES2");
bios.MEM.instance("IQTABLES2").comment = "IQ Math Table 2 in Boot ROM";
bios.MEM.instance("IQTABLES2").base = 0x3feb50;
bios.MEM.instance("IQTABLES2").len = 0x008c;
bios.MEM.instance("IQTABLES2").createHeap = 0;
bios.MEM.instance("IQTABLES2").space = "code";
bios.MEM.create("IQTABLES3");
bios.MEM.instance("IQTABLES3").comment = "IQ Math Table 3 in Boot ROM";
bios.MEM.instance("IQTABLES3").base = 0x3febdc;
bios.MEM.instance("IQTABLES3").len = 0x00aa;
bios.MEM.instance("IQTABLES3").createHeap = 0;
bios.MEM.instance("IQTABLES3").space = "code";
bios.MEM.create("DEVICE_CAL");
bios.MEM.instance("DEVICE_CAL").comment = "Device_cal Function in Reserved Memory";
bios.MEM.instance("DEVICE_CAL").base = 0x3d7c80;
bios.MEM.instance("DEVICE_CAL").len = 0x0040;
bios.MEM.instance("DEVICE_CAL").createHeap = 0;
bios.MEM.instance("DEVICE_CAL").space = "code";

bios.MEM.BIOSOBJSEG = prog.get("M1SARAM");
bios.MEM.MALLOCSEG = prog.get("M1SARAM");
bios.MEM.ARGSSEG = prog.get("LDPSARAM");
bios.MEM.STACKSEG = prog.get("M1SARAM");
bios.MEM.GBLINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.TRCDATASEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.TRCDATASEG = prog.get("LDPSARAM");
bios.MEM.SYSDATASEG = prog.get("LDPSARAM");
bios.MEM.OBJSEG = prog.get("LDPSARAM");
bios.MEM.BIOSSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.SYSINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.HWISEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.RTDXTEXTSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.TEXTSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.SWITCHSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.BSSSEG = prog.get("LDPSARAM");
bios.MEM.EBSSSEG = prog.get("LDPSARAM");
bios.MEM.CINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.PINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.ECONSTSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.CONSTSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.DATASEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.CIOSEG = prog.get("LDPSARAM");
bios.MEM.ENABLELOADADDR = 1;
bios.MEM.LOADBIOSSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADSYSINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADGBLINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADTRCDATASEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADTEXTSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADSWITCHSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADCINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADPINITSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADECONSTSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADCONSTSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADDATASEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADHWISEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADHWIVECSEG = prog.get("FLASH_ABCDEFGH");
bios.MEM.LOADRTDXTEXTSEG = prog.get("FLASH_ABCDEFGH");

bios.BUF.OBJMEMSEG = prog.get("LDPSARAM");
bios.SYS.TRACESEG = prog.get("LDPSARAM");
bios.LOG.OBJMEMSEG = prog.get("LDPSARAM");
bios.LOG.instance("LOG_system").bufSeg = prog.get("LDPSARAM");
bios.STS.OBJMEMSEG = prog.get("LDPSARAM");
bios.CLK.OBJMEMSEG = prog.get("LDPSARAM");
bios.PRD.OBJMEMSEG = prog.get("LDPSARAM");
bios.SWI.OBJMEMSEG = prog.get("LDPSARAM");
bios.TSK.OBJMEMSEG = prog.get("LDPSARAM");
bios.TSK.STACKSEG = prog.get("M1SARAM");
bios.TSK.instance("TSK_idle").stackMemSeg = prog.get("LDPSARAM");
bios.IDL.OBJMEMSEG = prog.get("LDPSARAM");
bios.SEM.OBJMEMSEG = prog.get("LDPSARAM");
bios.MBX.OBJMEMSEG = prog.get("LDPSARAM");
bios.QUE.OBJMEMSEG = prog.get("LDPSARAM");
bios.LCK.OBJMEMSEG = prog.get("LDPSARAM");
bios.DIO.OBJMEMSEG = prog.get("LDPSARAM");
bios.DHL.OBJMEMSEG = prog.get("LDPSARAM");
bios.RTDX.RTDXDATASEG = prog.get("LDPSARAM");
bios.HST.OBJMEMSEG = prog.get("LDPSARAM");
bios.HST.instance("RTA_fromHost").bufSeg = prog.get("LDPSARAM");
bios.HST.instance("RTA_toHost").bufSeg = prog.get("LDPSARAM");
bios.PIP.OBJMEMSEG = prog.get("LDPSARAM");
bios.SIO.OBJMEMSEG = prog.get("LDPSARAM");

bios.MEM.instance("FLASH").destroy();
bios.MEM.instance("MSARAM").destroy();
bios.MEM.instance("LSARAM").destroy();
bios.MEM.instance("DPSARAM").destroy();

bios.LOG.OBJMEMSEG = prog.get("M0SARAM");
bios.LOG.instance("LOG_system").bufSeg = prog.get("M0SARAM");
bios.LOG.instance("LOG_system").bufLen = 128;
bios.LOG.create("trace");
bios.LOG.instance("trace").bufSeg = prog.get("M0SARAM");
bios.LOG.instance("trace").bufLen = 64;





bios.PIE.instance("PIE_INT1_1").fxn = prog.extern("ADCINT1_ISR");
bios.PIE.instance("PIE_INT1_1").useDispatcher = 1;
bios.PIE.instance("PIE_INT4_1").fxn = prog.extern("ECAP1_INT_ISR");
bios.PIE.instance("PIE_INT4_1").useDispatcher = 1;

bios.SEM.create("TimeBase2msReady");
bios.SEM.create("SEM_TimeBase500ms");
bios.SEM.create("SEM_ProdToday_EEPROM");
bios.SEM.create("SEM_MasterCommTx");
bios.SEM.create("SEM_SCIAComm");
bios.PRD.create("TimeBase20ms_PRD");
bios.PRD.instance("TimeBase20ms_PRD").order = 2;
bios.PRD.create("TimeBase2ms_PRD");
bios.PRD.instance("TimeBase2ms_PRD").order = 3;
bios.PRD.create("TimeBase100ms_PRD");
bios.PRD.instance("TimeBase100ms_PRD").order = 4;
bios.PRD.create("TimeBase500ms_PRD");
bios.PRD.instance("TimeBase500ms_PRD").order = 5;
bios.PRD.instance("TimeBase100ms_PRD").period = 100;
bios.PRD.instance("TimeBase100ms_PRD").fxn = prog.extern("TimeBase100msPRD");
bios.PRD.instance("TimeBase20ms_PRD").period = 20;
bios.PRD.instance("TimeBase20ms_PRD").fxn = prog.extern("TimeBase20msPRD");
bios.PRD.instance("TimeBase2ms_PRD").period = 2;
bios.PRD.instance("TimeBase2ms_PRD").fxn = prog.extern("TimeBase2msPRD");
bios.PRD.instance("TimeBase500ms_PRD").period = 500;
bios.PRD.instance("TimeBase500ms_PRD").fxn = prog.extern("TimeBase500msPRD");
bios.SEM.create("SEM_GridPeriod");
bios.SEM.create("MpptReady");
bios.SEM.create("SEM_I2C_isr");
bios.SEM.create("FrequencyOfGridReady");
bios.SEM.create("SEM_MasterComm");
bios.SEM.create("SEM_MasterCommRx");
bios.LCK.create("LCK_ProdToday_EEPROM");
bios.MEM.STACKSIZE = 0x0200;
bios.SWI.create("SWI_SCIARXINT");
bios.SWI.instance("SWI_SCIARXINT").order = 2;
bios.SWI.instance("SWI_SCIARXINT").priority = 2;
bios.SWI.instance("SWI_SCIARXINT").fxn = prog.extern("SWI_SCIARXISR");
bios.SWI.instance("SWI_SCIARXINT").priority = 1;
bios.PIE.instance("PIE_INT9_1").fxn = prog.extern("SCIRXINTA_ISR");
bios.PIE.instance("PIE_INT9_1").useDispatcher = 1;
bios.TSK.create("TSK_COM_PC");
bios.TSK.instance("TSK_COM_PC").order = 1;
bios.TSK.instance("TSK_COM_PC").stackSize = 128;
bios.TSK.instance("TSK_COM_PC").stackMemSeg = prog.get("M0SARAM");
bios.TSK.instance("TSK_COM_PC").fxn = prog.extern("TSK_SCI_B");

bios.TSK.instance("TSK_COM_PC").priority = 8;
bios.PIE.instance("PIE_INT6_3").fxn = prog.extern("SPIRXINTB_ISR");
bios.PIE.instance("PIE_INT6_3").useDispatcher = 1;
bios.SWI.create("SWI_SPIBRXINT");
bios.SWI.instance("SWI_SPIBRXINT").order = 3;
bios.SWI.instance("SWI_SPIBRXINT").priority = 2;
bios.MEM.STACKSIZE = 0x0300;
bios.SWI.instance("PRD_swi").priority = 4;
bios.SWI.instance("SWI_SPIBRXINT").priority = 5;
bios.SWI.instance("SWI_SPIBRXINT").fxn = prog.extern("SWI_SPIBRXINTISR");
bios.MEM.STACKSIZE = 0x0250;
bios.MEM.STACKSIZE = 0x0300;
bios.MEM.instance("LDPSARAM").createHeap = 1;
bios.MEM.instance("LDPSARAM").createHeap = 0;
bios.MEM.NOMEMORYHEAPS = 1;
bios.TSK.create("SPIB_TX_Task");
bios.TSK.instance("SPIB_TX_Task").order = 3;
bios.TSK.instance("SPIB_TX_Task").stackSize = 128;
bios.TSK.instance("SPIB_TX_Task").fxn = prog.extern("TSK_Spib_Transmit");
bios.TSK.instance("SPIB_TX_Task").priority = 5;
bios.TSK.create("SPIB_RX_Task");
bios.TSK.instance("SPIB_RX_Task").order = 4;
bios.TSK.instance("SPIB_RX_Task").stackSize = 128;
bios.TSK.instance("SPIB_RX_Task").fxn = prog.extern("TSK_Spib_Receive");
bios.TSK.instance("SPIB_RX_Task").priority = 12;
bios.TSK.instance("SPIB_TX_Task").priority = 11;
bios.PIE.instance("PIE_INT1_4").fxn = prog.extern("XINT1_ISR", "asm");
bios.PIE.instance("PIE_INT1_4").useDispatcher = 1;
bios.PIE.instance("PIE_INT1_4").fxn = prog.extern("XINT1_ISR");
bios.SWI.create("SWI_XINT1");
bios.SWI.instance("SWI_XINT1").order = 4;
bios.SWI.instance("SWI_XINT1").priority = 5;
bios.SWI.instance("SWI_XINT1").fxn = prog.extern("SWI_SpiWrite_dummy");
bios.SWI.instance("SWI_XINT1").priority = 6;
bios.TSK.create("State_Switch");
bios.TSK.instance("State_Switch").order = 5;
bios.TSK.instance("State_Switch").stackSize = 128;
bios.TSK.instance("State_Switch").priority = 15;
bios.TSK.instance("State_Switch").fxn = prog.extern("StateSwitch");
bios.TSK.create("TSK_Grid_Period");
bios.TSK.instance("TSK_Grid_Period").order = 6;
bios.TSK.instance("TSK_Grid_Period").stackSize = 128;
bios.TSK.instance("TSK_Grid_Period").fxn = prog.extern("TSK_GridPeriod");
bios.TSK.instance("TSK_Grid_Period").priority = 14;
bios.TSK.create("Mppt_Task");
bios.TSK.instance("Mppt_Task").order = 7;
bios.TSK.instance("Mppt_Task").stackSize = 128;
bios.TSK.instance("Mppt_Task").priority = 13;
bios.TSK.instance("Mppt_Task").fxn = prog.extern("MpptTask");
bios.TSK.instance("TSK_idle").order = 1;
bios.TSK.instance("TSK_COM_PC").order = 2;

bios.TSK.instance("SPIB_TX_Task").order = 4;
bios.TSK.instance("SPIB_RX_Task").order = 5;
bios.TSK.instance("State_Switch").destroy();
bios.TSK.instance("Mppt_Task").destroy();
bios.TSK.instance("TSK_Grid_Period").destroy();
bios.TSK.STACKSIZE = 128;
bios.TSK.create("Mppt_Task");
bios.TSK.instance("Mppt_Task").order = 7;
bios.TSK.instance("Mppt_Task").fxn = prog.extern("MpptTask");
bios.TSK.instance("Mppt_Task").priority = 14;
bios.TSK.instance("Mppt_Task").priority = 13;
bios.TSK.create("State_Switch");
bios.TSK.instance("State_Switch").order = 8;
bios.TSK.instance("State_Switch").fxn = prog.extern("StateSwitch");
bios.TSK.create("TSK_Grid_Period");
bios.TSK.instance("TSK_Grid_Period").order = 9;
bios.TSK.instance("TSK_Grid_Period").priority = 14;
bios.TSK.instance("TSK_Grid_Period").fxn = prog.extern("TSK_GridPeriod");
bios.TSK.instance("State_Switch").priority = 15;
bios.SWI.instance("PRD_swi").order = 1;
bios.SWI.instance("KNL_swi").order = 2;
bios.SWI.instance("SWI_SCIARXINT").order = 3;
bios.SWI.instance("SWI_SPIBRXINT").order = 4;
bios.SWI.instance("SWI_XINT1").order = 5;

bios.MEM.STACKSIZE = 0x0400;
bios.SEM.create("SEM_SLAVE_DATA_RDY");
bios.PRD.instance("TimeBase20ms_PRD").order = 1;
bios.PRD.instance("TimeBase2ms_PRD").order = 2;
bios.PRD.instance("TimeBase500ms_PRD").order = 3;
bios.PRD.instance("TimeBase100ms_PRD").destroy();
bios.SEM.create("SEM_SafeEEprom");
bios.TSK.instance("SPIB_TX_Task").order = 3;
bios.TSK.instance("SPIB_RX_Task").order = 4;
bios.TSK.instance("Mppt_Task").order = 5;
bios.TSK.instance("State_Switch").order = 6;
bios.TSK.instance("TSK_Grid_Period").order = 7;

bios.TSK.create("TSK_EEPROM");
bios.TSK.instance("TSK_EEPROM").order = 9;
bios.TSK.instance("TSK_EEPROM").fxn = prog.extern("TSK_F_ProdToday_EEprom");
bios.TSK.instance("TSK_EEPROM").priority = 4;
bios.TSK.instance("TSK_EEPROM").stackSize = 256;
bios.PIE.instance("PIE_INT8_1").fxn = prog.extern("I2CINT1A_ISR");
bios.PIE.instance("PIE_INT8_1").useDispatcher = 1;
bios.SWI.create("I2C_swi");
bios.SWI.instance("I2C_swi").order = 6;
bios.SWI.instance("I2C_swi").priority = 6;
bios.SWI.instance("I2C_swi").priority = 5;
bios.SWI.instance("I2C_swi").fxn = prog.extern("SWI_I2C_handle");
bios.SWI.instance("I2C_swi").order = 5;
bios.SWI.instance("SWI_XINT1").destroy();
bios.SWI.instance("I2C_swi").order = 4;
bios.SWI.instance("SWI_SPIBRXINT").destroy();
bios.TSK.instance("Mppt_Task").order = 4;
bios.TSK.instance("State_Switch").order = 5;
bios.TSK.instance("TSK_Grid_Period").order = 6;
bios.TSK.instance("TSK_EEPROM").order = 7;
bios.TSK.instance("SPIB_RX_Task").destroy();
bios.TSK.instance("Mppt_Task").order = 3;
bios.TSK.instance("State_Switch").order = 4;
bios.TSK.instance("TSK_Grid_Period").order = 5;
bios.TSK.instance("TSK_EEPROM").order = 6;
bios.TSK.instance("SPIB_TX_Task").destroy();
bios.TSK.instance("State_Switch").order = 3;
bios.TSK.instance("TSK_Grid_Period").order = 4;
bios.TSK.instance("TSK_EEPROM").order = 5;
bios.TSK.instance("Mppt_Task").destroy();
bios.SEM.instance("MpptReady").destroy();
bios.SEM.instance("SEM_SCIAComm").destroy();
bios.SEM.instance("SEM_SLAVE_DATA_RDY").destroy();
bios.PIE.instance("PIE_INT1_4").fxn = prog.extern("HWI_unused", "asm");
bios.PIE.instance("PIE_INT1_4").useDispatcher = 0;
bios.PIE.instance("PIE_INT6_3").fxn = prog.extern("HWI_unused", "asm");
bios.PIE.instance("PIE_INT6_3").useDispatcher = 0;
bios.SWI.instance("I2C_swi").destroy();
bios.TSK.instance("TSK_EEPROM").destroy();
bios.SEM.instance("SEM_MasterComm").destroy();
bios.SEM.instance("SEM_MasterCommRx").destroy();
bios.SEM.instance("SEM_MasterCommTx").destroy();
bios.SEM.instance("SEM_I2C_isr").destroy();
bios.SEM.instance("SEM_ProdToday_EEPROM").destroy();
bios.SWI.create("SWI_SCILINREINT");
bios.SWI.instance("SWI_SCILINREINT").order = 4;
bios.SWI.instance("SWI_SCILINREINT").priority = 4;
bios.SWI.instance("SWI_SCILINREINT").priority = 3;
bios.SWI.instance("SWI_SCILINREINT").fxn = prog.extern("D");
bios.SWI.instance("SWI_SCILINREINT").fxn = prog.extern("SWI_SCILINRXISR");
bios.SEM.create("SEM_SCIAComm");
bios.SWI.instance("SWI_SCILINREINT").destroy();
bios.SWI.create("SWI_SCILINRXINT");
bios.SWI.instance("SWI_SCILINRXINT").order = 5;
bios.SWI.instance("SWI_SCILINRXINT").priority = 4;
bios.SWI.instance("SWI_SCILINRXINT").priority = 3;
bios.SWI.instance("SWI_SCILINRXINT").fxn = prog.extern("SWI_SCILINISR");
bios.SWI.instance("SWI_SCILINRXINT").fxn = prog.extern("SWI_SCILINRXISR");
bios.SEM.instance("SEM_SafeEEprom").destroy();
bios.SEM.create("SEM_Time_Record");
bios.SEM.instance("FrequencyOfGridReady").destroy();
// !GRAPHICAL_CONFIG_TOOL_SCRIPT_INSERT_POINT!

prog.gen();

